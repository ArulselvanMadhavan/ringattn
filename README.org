* Ring Attention
- Code block
#+begin_export bash
e â† 4
t â† 8
n â† 8
b â† t Ã· n
sh â† tâ€¿e
blk_sh â† nâ€¿bâ€¿e
MakeMat â† (â†•Ã—Â´)âŠ¸(â¥ŠËœ)
MatMul â† +Ëâˆ˜Ã—â‰1â€¿âˆ
q â† MakeMat sh
k â† MakeMat sh
v â† MakeMat sh
a â† q MatMul (â‰k)
out â† a MatMul v
qnâ€¿knâ€¿vn â† blk_shâŠ¸â¥ŠÂ¨ qâ€¿kâ€¿v

Step â† {ğ•Šhâ€¿o:
qd â† hâŠqn
kd â† oâŠkn
vd â† oâŠvn
ad â† qd MatMul (â‰kd)
ad Matmul vd
}

order â† (â†•n) âŒ½Ë˜ (â‰((â†•n)â‹ˆâŒœ(â†•n)))
res â† StepÂ¨ (â¥Šorder)
#â€¢Show (Â¯1Ã—â†•n) âŒ½Ë˜ (â‰order)
ores â† (Â¯1Ã—â†•n) âŒ½Ë˜ (â‰(â‰¢order)â¥Šres)
out â‰¡ tâ€¿eâ¥Š>+Ëores
#+end_export
